#:include gui/builtwidgets.kv
#:include gui/load.kv
#:include gui/welcome.kv
#:include gui/playeramount.kv
#:include gui/revealdirections.kv
#:include dialogs/identitydialog.kv
#:include dialogs/confirmdialog.kv
#:include dialogs/rematchdialog.kv
#:include dialogs/actiondialog.kv
#:include dialogs/logdialog.kv
#:include gui/maininformation.kv
#:include gui/colorselect.kv
#:include gui/endgame.kv
#:import C kivy.utils.get_color_from_hex
#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:import SwapTransition kivy.uix.screenmanager.SwapTransition
#:include gui/mainscreens/Timer.kv
#:include gui/mainscreens/Action.kv
#:include gui/mainscreens/PlayerLog.kv

WindowManager:
    transition: SlideTransition()
    LoadingScreen:
    WelcomeWindow:
    PlayerWindow:
    ColorSelectScreen:
    PlayerReveal:
    MainWindow:
    EndGame:
    MainInfo:

<MainWindow>:
    name: "main"

    Background:

    MDBoxLayout:
        orientation: "vertical"

        MDToolbar:
            title: "C0de.Net"
            right_action_items: [["information-outline", lambda x: root.openinfo()]]

        MDStackLayout:
            size_hint_y: 1/6
            spacing: "8dp"
            padding: "8dp"

            MDLabel:
                adaptive_height: True
                theme_text_color: "Custom"
                font_style: "H4"
                halign: "center"
                text_color: C("FFFFFF")
                text: "Main"

            MDSeparator:
                color: C("FFFFFF")

            MDBoxLayout:
                orientation: "horizontal"
                spacing: "4dp"
                adaptive_height: True

                MDIcon:
                    id: hacker_identifer
                    icon: "shield-bug"
                    text_color: C(app.globals.colordefs['Red'])
                    theme_text_color: "Custom"
                    adaptive_height: True
                    badge_bg_color: C('000000')
                    badge_icon_color: C(app.globals.colordefs['Red'])

                MDIcon:
                    id: coder_identifer
                    icon: "shield-lock"
                    text_color: C(app.globals.colordefs['Blue'])
                    theme_text_color: "Custom"
                    adaptive_height: True
                    badge_bg_color: C('000000')
                    badge_icon_color: C(app.globals.colordefs['Blue'])

                MDLabel:
                    text_color: app.theme_cls.primary_color
                    theme_text_color: "Custom"
                    id: currentround
                    text: f"[size=30sp][font=Icons]{md_icons['circle-outline']}{md_icons['circle-outline']}{md_icons['circle-outline']}[/font][/size]"
                    markup: True
                    halign: "center"

                MDIcon:
                    id: ai_identifer
                    icon: "account-circle"
                    text_color: C('FFFFFF')
                    theme_text_color: "Custom"
                    adaptive_height: True
                    badge_bg_color: C('000000')
                    badge_icon_color: C('FFFFFF')

                MDIcon:
                    id: player_identifer
                    icon: "account-supervisor-circle"
                    text_color: app.theme_cls.primary_color
                    theme_text_color: "Custom"
                    adaptive_height: True
                    badge_bg_color: C('000000')
                    badge_icon_color: app.theme_cls.primary_color

        MDBoxLayout:
            size_hint_y: 2/5
            orientation: "vertical"

            ScreenManager:
                id: mainscreenmanager

                transition: SwapTransition()
                Timer:
                ActionScreen:
                PlayerLogScreen:

        MDBoxLayout:
            orientation: "vertical"
            padding: "0dp", "8dp", "0dp", "55dp"

            MDTabs:
                indicator_color: C('FFFFFF')
                text_color_active: C('FFFFFF')
                text_color_normal: C('FFFFFF')
                id: mainpanel
                tab_hint_x: True
                allow_stretch: True
                lock_swiping: True
                tab_indicator_anim: True

                Tab:
                    title: "[font=Button]ROUND 1[/font]"
                    markup: True
                    icon: "archive-lock"

                    MDBoxLayout:
                        orientation: "vertical"
                        padding: "8dp"
                        spacing: "8dp"

                        Widget:

                        MDLabel:
                            adaptive_height: True
                            size_hint_x: None
                            width: self.texture_size[0]
                            text_size: None, None
                            text: f" [font=Icons]{md_icons['folder-lock']}[/font] Main Log "
                            theme_text_color: "Custom"
                            font_style: 'H6'
                            text_color: C('#FFFFFF')
                            pos_hint: {"center_x": 0.5}
                            markup: True
                            canvas.before:
                                Color:
                                    rgba: app.theme_cls.primary_color
                                RoundedRectangle:
                                    pos: self.x - 8, self.y - 3
                                    size: self.width + 16, self.height + 6
                                    radius: [dp(5)]

                        MDBoxLayout:
                            pos_hint: {"center_x":0.5, "y": 0}
                            orientation: "vertical"
                            canvas.before:
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.3
                                Line:
                                    width: dp(1.2)
                                    rectangle: self.x, self.y, self.width, self.height
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.06
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                            MDLabel:
                                id: round1sub
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                halign: "center"
                                markup: True
                                text: f"[size=22sp][font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font][/size]"

                            MDLabel:
                                adaptive_height: True
                                id: round1subtext
                                halign: 'center'
                                text_color: C('#FFFFFF')
                                adaptive_height: True
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                text: " "
                                markup: True

                            MDLabel:
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Caption'
                                halign: "center"
                                markup: True
                                text: "At least one hacker is among the following."

                        Widget:

                Tab:
                    title: "[font=Button]ROUND 2[/font]"
                    markup: True
                    icon: "archive"

                    MDBoxLayout:
                        orientation: "vertical"
                        padding: "8dp"
                        spacing: "8dp"

                        MDLabel:
                            id: logtitle1
                            adaptive_height: True
                            size_hint_x: None
                            width: self.texture_size[0]
                            text_size: None, None
                            text: f" [font=Icons]{md_icons['folder']}[/font] First Log "
                            theme_text_color: "Custom"
                            font_style: 'H6'
                            text_color: C('#FFFFFF')
                            pos_hint: {"center_x": 0.5}
                            markup: True
                            canvas.before:
                                Color:
                                    group: '1'
                                    rgba: app.theme_cls.primary_color
                                RoundedRectangle:
                                    pos: self.x - 8, self.y - 3
                                    size: self.width + 16, self.height + 6
                                    radius: [dp(5)]

                        MDBoxLayout:
                            pos_hint: {"center_x":0.5, "y": 0}
                            orientation: "vertical"
                            canvas.before:
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.3
                                Line:
                                    width: dp(1.2)
                                    rectangle: self.x, self.y, self.width, self.height
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.06
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                            MDLabel:
                                id: round2sub1
                                markup: True
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                halign: "center"
                                text: f"[size=22sp][font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font][/size]"

                            MDLabel:
                                adaptive_height: True
                                id: round2sub1text
                                halign: 'center'
                                text: " "
                                text_color: C('#FFFFFF')
                                adaptive_height: True
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                markup: True

                            MDLabel:
                                id: round2sum1
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Caption'
                                halign: "center"
                                markup: True
                                text: "At least one hacker may be among the following."

                        MDLabel:
                            id: logtitle2
                            adaptive_height: True
                            size_hint_x: None
                            width: self.texture_size[0]
                            text_size: None, None
                            text: f" [font=Icons]{md_icons['folder']}[/font] Second Log "
                            theme_text_color: "Custom"
                            font_style: 'H6'
                            text_color: C('#FFFFFF')
                            pos_hint: {"center_x": 0.5}
                            markup: True
                            canvas.before:
                                Color:
                                    group: '2'
                                    rgba: app.theme_cls.primary_color
                                RoundedRectangle:
                                    pos: self.x - 8, self.y - 3
                                    size: self.width + 16, self.height + 6
                                    radius: [dp(5)]

                        MDBoxLayout:
                            pos_hint: {"center_x":0.5, "y": 0}
                            orientation: "vertical"
                            canvas.before:
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.3
                                Line:
                                    width: dp(1.2)
                                    rectangle: self.x, self.y, self.width, self.height
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.06
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                            MDLabel:
                                id: round2sub2
                                markup: True
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                halign: "center"
                                text: f"[size=22sp][font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font][/size]"

                            MDLabel:
                                adaptive_height: True
                                id: round2sub2text
                                text: " "
                                halign: 'center'
                                text_color: C('#FFFFFF')
                                adaptive_height: True
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                markup: True

                            MDLabel:
                                id: round2sum2
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Caption'
                                halign: "center"
                                markup: True
                                text: "At least one hacker may be among the following."

                        MDLabel:
                            id: logtitle3
                            adaptive_height: True
                            size_hint_x: None
                            width: self.texture_size[0]
                            text_size: None, None
                            text: f" [font=Icons]{md_icons['folder']}[/font] Third Log "
                            theme_text_color: "Custom"
                            font_style: 'H6'
                            text_color: C('#FFFFFF')
                            pos_hint: {"center_x": 0.5}
                            markup: True
                            canvas.before:
                                Color:
                                    group: '3'
                                    rgba: app.theme_cls.primary_color
                                RoundedRectangle:
                                    pos: self.x - 8, self.y - 3
                                    size: self.width + 16, self.height + 6
                                    radius: [dp(5)]

                        MDBoxLayout:
                            pos_hint: {"center_x":0.5, "y": 0}
                            orientation: "vertical"
                            canvas.before:
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.3
                                Line:
                                    width: dp(1.2)
                                    rectangle: self.x, self.y, self.width, self.height
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.06
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                            MDLabel:
                                id: round2sub3
                                markup: True
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                halign: "center"
                                text: f"[size=22sp][font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font][/size]"

                            MDLabel:
                                adaptive_height: True
                                id: round2sub3text
                                halign: 'center'
                                text: " "
                                text_color: C('#FFFFFF')
                                adaptive_height: True
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                markup: True

                            MDLabel:
                                id: round2sum3
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Caption'
                                halign: "center"
                                markup: True
                                text: "At least one hacker may be among the following."

                Tab:
                    title: "[font=Button]ROUND 3[/font]"
                    markup: True
                    icon: "archive-eye"

                    MDBoxLayout:
                        orientation: "vertical"
                        padding: "8dp"
                        spacing: "8dp"

                        Widget:
                            size_hint: 1, 0.5

                        MDLabel:
                            id:playerlog1
                            adaptive_height: True
                            size_hint_x: None
                            width: self.texture_size[0]
                            text_size: None, None
                            text: f" [font=Icons]{md_icons['folder-eye']}[/font] Player Log "
                            theme_text_color: "Custom"
                            font_style: 'H6'
                            text_color: C('#FFFFFF')
                            pos_hint: {"center_x": 0.5}
                            markup: True
                            canvas.before:
                                Color:
                                    group: '1'
                                    rgba: app.theme_cls.primary_color
                                RoundedRectangle:
                                    pos: self.x - 8, self.y - 3
                                    size: self.width + 16, self.height + 6
                                    radius: [dp(5)]

                        MDBoxLayout:
                            pos_hint: {"center_x":0.5, "y": 0}
                            orientation: "vertical"
                            canvas.before:
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.3
                                Line:
                                    width: dp(1.2)
                                    rectangle: self.x, self.y, self.width, self.height
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.06
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                            MDLabel:
                                id: round3sum1
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                halign: "center"
                                markup: True
                                text: f"[size=22sp][font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font][/size]"

                            MDLabel:
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Caption'
                                halign: "center"
                                text: "Exactly one hacker is among the following."

                        MDLabel:
                            id:playerlog2
                            adaptive_height: True
                            size_hint_x: None
                            font_style: 'H6'
                            width: self.texture_size[0]
                            text_size: None, None
                            text: f" [font=Icons]{md_icons['folder-eye']}[/font] Player Log "
                            theme_text_color: "Custom"
                            markup: True
                            text_color: C('#FFFFFF')
                            pos_hint: {"center_x": 0.5}
                            canvas.before:
                                Color:
                                    group: '2'
                                    rgba: app.theme_cls.primary_color
                                RoundedRectangle:
                                    pos: self.x - 8, self.y - 3
                                    size: self.width + 16, self.height + 6
                                    radius: [dp(5)]

                        MDBoxLayout:
                            pos_hint: {"center_x":0.5, "y": 0}
                            orientation: "vertical"
                            canvas.before:
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.3
                                Line:
                                    width: dp(1.2)
                                    rectangle: self.x, self.y, self.width, self.height
                                Color:
                                    rgba: 51/255, 255/255, 51/255, 0.06
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                            MDLabel:
                                id: round3sum2
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Subtitle2'
                                halign: "center"
                                markup: True
                                text: f"[size=22sp][font=Icons]{md_icons['file']}[/font] [font=Icons]{md_icons['file']}[/font][/size]"

                            MDLabel:
                                text_color: app.theme_cls.primary_color
                                theme_text_color: "Custom"
                                font_style: 'Caption'
                                halign: "center"
                                text: "Exactly one hacker is among the following."

                        Widget:
                            size_hint: 1, 0.5

        MDBottomAppBar:
            MDToolbar:
                id: roundregulator
                icon: "play"
                type: "bottom"
                on_action_button: root.mainactioncheck()